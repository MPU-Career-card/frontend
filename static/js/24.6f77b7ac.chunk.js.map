{"version":3,"file":"static/js/24.6f77b7ac.chunk.js","mappings":"gNAsBA,MA2HA,EA3HwBA,KACpB,MAAOC,EAAcC,IAAmBC,EAAAA,EAAAA,UAAuB,CAAC,IACzDC,EAAWC,IAAgBF,EAAAA,EAAAA,WAAkB,IAC7CG,EAAaC,IAAkBJ,EAAAA,EAAAA,aAC/BK,EAAWC,IAAgBN,EAAAA,EAAAA,YAE5BO,GAAcC,EAAAA,EAAAA,SAAgB,GAE9BC,EAAeC,UACjB,IACIR,GAAa,GAEb,MAAQS,KAAMC,SAAoBC,EAAAA,GAAaC,IAAc,IACvDhB,EAAec,EAAUG,QAAO,CAACC,EAAKC,KAAO,IAC5CD,EACH,CAACC,GAAU,MACX,CAAC,GAELlB,EAAgBD,EACpB,CAAE,MAAOoB,GACL,GAAIA,aAAeC,EAAAA,GAAY,CAC3B,MAAM,OAAEC,EAAQT,MAAM,OAAEU,IAAaH,EAAII,UAAY,CAAEX,KAAM,CAAC,GAE9DP,EAAegB,GACfd,EAAae,EACjB,CACJ,CAAC,QACGnB,GAAa,EACjB,GAqDEqB,GAAkBC,EAAAA,EAAAA,KA9BTd,UACX,IAAKe,EAID,OAHAlB,EAAYmB,SAAU,OACtBjB,IAKJ,IACIF,EAAYmB,SAAU,EAEtB,MAAM,KAAEf,SAAegB,EAAAA,EAAAA,IAAmBF,GACpC3B,EAA6B8B,OAAOC,KAAKlB,GAAMI,QAAO,CAACC,EAAKC,KAAO,IAClED,EACH,CAACC,GAAUN,EAAKM,GAASnB,gBACzB,CAAC,GAELgC,QAAQC,IAAI,CAAEjC,iBAEdC,EAAgBD,EACpB,CAAE,MAAOoB,GACL,GAAIA,aAAeC,EAAAA,GAAY,CAC3B,MAAM,OAAEC,EAAQT,MAAM,OAAEU,IAAaH,EAAII,UAAY,CAAEX,KAAM,CAAC,GAE9DP,EAAegB,GACfd,EAAae,EACjB,CACJ,IAGqC,KAUzC,OAJAW,EAAAA,EAAAA,YAAU,KACNvB,GAAc,GACf,IAECR,GACOgC,EAAAA,EAAAA,KAACC,EAAAA,EAAO,IAGf/B,GAAeE,GAEX4B,EAAAA,EAAAA,KAACE,EAAAA,EAAK,CACFf,OAAQjB,EACRiC,YAAa/B,KAKrBgC,EAAAA,EAAAA,MAACC,EAAAA,GAAS,CAAAC,SAAA,EACNN,EAAAA,EAAAA,KAACO,EAAAA,GAAiB,CACdC,MAAO,6BACPC,MAAM,wFACNN,YAAY,mrBAGhBH,EAAAA,EAAAA,KAACU,EAAAA,GAAmB,CAChB7C,aAAcA,EACd8C,gBAlFYlC,UACpB,IAAIH,EAAYmB,QAEhB,IACI,MAAM,KAAEf,SAAekC,EAAAA,EAAAA,IAAW5B,GAElClB,GAAiBD,IAAY,IACtBA,EACH,CAACmB,GAAUN,EAAKb,gBAExB,CAAE,MAAOoB,GACL,GAAIA,aAAeC,EAAAA,GAAY,CAC3B,MAAM,OAAEC,EAAQT,MAAM,OAAEU,IAAaH,EAAII,UAAY,CAAEX,KAAM,CAAC,GAE9DP,EAAegB,GACfd,EAAae,EACjB,CACJ,GAkEQyB,oBA/BiBC,IACzBxB,EAAgBwB,EAAEC,OAAOC,MAAM,EA+BvBC,UAAW,IACXC,aAAc,OAElBlB,EAAAA,EAAAA,KAACmB,EAAAA,GAAM,MACC,C","sources":["pages/specialties/ui/specialties.tsx"],"sourcesContent":["import {\n    ChangeEvent, useEffect, useRef, useState,\n} from 'react';\nimport { AxiosError } from 'axios';\n\nimport {\n    Footer,\n    SpecialitiesPromo,\n    FacultiesAccordions,\n} from 'widgets';\nimport { Container } from 'shared/ui';\nimport {\n    debounce,\n    facultiesApi,\n    getFaculty,\n    searchSpecialities,\n} from 'shared/lib';\nimport { Specialities } from 'shared/types';\n\nimport { Loading } from '../../loading';\nimport { Error } from '../../error';\n\nconst SpecialtiesPage = () => {\n    const [specialities, setSpecialities] = useState<Specialities>({});\n    const [isLoading, setIsLoading] = useState<boolean>(false);\n    const [errorStatus, setErrorStatus] = useState<number>();\n    const [errorText, setErrorText] = useState<string>();\n\n    const isSearching = useRef<boolean>(false);\n\n    const getFaculties = async () => {\n        try {\n            setIsLoading(true);\n\n            const { data: faculties } = await facultiesApi.get<string[]>('');\n            const specialities = faculties.reduce((acc, faculty) => ({\n                ...acc,\n                [faculty]: [],\n            }), {});\n\n            setSpecialities(specialities);\n        } catch (err) {\n            if (err instanceof AxiosError) {\n                const { status, data: { detail } } = err.response || { data: {} };\n\n                setErrorStatus(status);\n                setErrorText(detail);\n            }\n        } finally {\n            setIsLoading(false);\n        }\n    };\n\n    const getSpecialities = async (faculty: string) => {\n        if (isSearching.current) return;\n\n        try {\n            const { data } = await getFaculty(faculty);\n\n            setSpecialities((specialities) => ({\n                ...specialities,\n                [faculty]: data.specialities,\n            }));\n        } catch (err) {\n            if (err instanceof AxiosError) {\n                const { status, data: { detail } } = err.response || { data: {} };\n\n                setErrorStatus(status);\n                setErrorText(detail);\n            }\n        }\n    };\n\n    const search = async (search: string) => {\n        if (!search) {\n            isSearching.current = false;\n            getFaculties();\n\n            return;\n        }\n\n        try {\n            isSearching.current = true;\n\n            const { data } = await searchSpecialities(search);\n            const specialities: Specialities = Object.keys(data).reduce((acc, faculty) => ({\n                ...acc,\n                [faculty]: data[faculty].specialities,\n            }), {});\n\n            console.log({ specialities });\n\n            setSpecialities(specialities);\n        } catch (err) {\n            if (err instanceof AxiosError) {\n                const { status, data: { detail } } = err.response || { data: {} };\n\n                setErrorStatus(status);\n                setErrorText(detail);\n            }\n        }\n    };\n\n    const debouncedSearch = debounce(search, 300);\n\n    const onSearchInputChange = (e: ChangeEvent<HTMLInputElement>) => {\n        debouncedSearch(e.target.value);\n    };\n\n    useEffect(() => {\n        getFaculties();\n    }, []);\n\n    if (isLoading) {\n        return <Loading />;\n    }\n\n    if (errorStatus || errorText) {\n        return (\n            <Error\n                status={errorStatus}\n                description={errorText}\n            />\n        );\n    }\n    return (\n        <Container>\n            <SpecialitiesPromo\n                image={`${process.env.PUBLIC_URL}/assets/promo.jpg`}\n                title=\"Карьерные карты\"\n                description=\"- это проект, который поможет тебе определиться с\n                будущей профессией и выбрать нужное направление подготовки в Московском Политехе\"\n            />\n            <FacultiesAccordions\n                specialities={specialities}\n                getSpecialities={getSpecialities}\n                onSearchInputChange={onSearchInputChange}\n                marginTop={100}\n                marginBottom={100}\n            />\n            <Footer />\n        </Container>\n    );\n};\n\nexport default SpecialtiesPage;\n"],"names":["SpecialtiesPage","specialities","setSpecialities","useState","isLoading","setIsLoading","errorStatus","setErrorStatus","errorText","setErrorText","isSearching","useRef","getFaculties","async","data","faculties","facultiesApi","get","reduce","acc","faculty","err","AxiosError","status","detail","response","debouncedSearch","debounce","search","current","searchSpecialities","Object","keys","console","log","useEffect","_jsx","Loading","Error","description","_jsxs","Container","children","SpecialitiesPromo","image","title","FacultiesAccordions","getSpecialities","getFaculty","onSearchInputChange","e","target","value","marginTop","marginBottom","Footer"],"sourceRoot":""}